import e from"jquery";const t=!0;class n{#e=[];#t;constructor(e){this.#t=e}effect(e){this.#e.push(e)}get value(){return this.#t}set value(e){t&&(this.#t=e,this.#e.forEach((e=>e())))}}function r(e){return new n(e)}r.depends=function(e,t){const r=new n(t());return e.forEach((e=>{if(!e instanceof n)throw new Error("dependencies must be a signal");e.effect((()=>r.value=t()))})),r};class o{#e=[];#n;constructor(e){this.#n=e}get content(){return this.#n}set content(e){t&&(this.#n.replaceWith(e),this.#n=e,this.#e.forEach((e=>e())))}}function a(e){return new o(e)}function c(t,r){if(["boolean","string","number","float"].includes(typeof t))e(r).append(window.document.createTextNode(String(t)));else if(t instanceof n){let n=window.document.createTextNode(t.value);e(r).append(n),t.effect((()=>n.textContent=t.value))}else t instanceof o?e(r).append(t.content):Array.isArray(t)?t.forEach((e=>c(e,r))):e(r).append(t)}function i(r,o,...a){if("function"==typeof r)return r({...o,children:a});if("string"==typeof r){let i=window.document.createElement(r);if(null!==o&&"object"==typeof o){const r=["css$","bindVal$","className","htmlFor"],a=/^ev\$([a-z]+)$/;if(t&&Object.keys(o).filter((e=>a.test(e))).forEach((t=>{e(i).on(t.replace(a,"$1"),o[t])})),"css$"in o&&"object"==typeof o.css$&&e(i).css(o.css$),"className"in o&&(i.className=o.className),"htmlFor"in o&&(i.htmlFor=o.htmlFor),"bindVal$"in o){if(!o.bindVal$ instanceof n)throw new Error("bindVal$ must be a signal");e(i).val(o.bindVal$.value),t&&(e(i).on("input",(function(){o.bindVal$.value=e(this).val()})),o.bindVal$.effect((()=>{e(i).val()!==o.bindVal$.value&&e(i).val(o.bindVal$.value)})))}Object.keys(o).filter((e=>!r.includes(e)&&!a.test(e))).forEach((e=>{i.setAttribute(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),o[e])}))}let l=!1;for(const e of a)if(e instanceof Promise){l=!0;break}return l?new Promise(((t,n)=>{Promise.all(a).then((n=>{n.forEach((e=>c(e,i))),t(e(i))})).catch((e=>n(e)))})):(a.forEach((e=>c(e,i))),e(i))}throw new Error("tag must be function or string")}function l({children:t}){let n=window.document.createDocumentFragment();return t.forEach((e=>c(e,n))),e(n)}function s({children:e,predicate:t}){if(!t instanceof n)throw new Error("'predicate' must be a boolean signal");if("boolean"!=typeof t.value)throw new Error("'predicate' must be a boolean signal");if(2!==e.length)throw new Error("the 'Case' component can take exactly two children");const r=i(l,null,...e);return!0===t.value?e[1].hide():e[0].hide(),t.effect((()=>{!0===t.value?(e[1].hide(),e[0].show()):(e[0].hide(),e[1].show())})),r}function f({children:t,array:r,wrapper:o="div"}){if(!r instanceof n)throw new Error("the 'array' attribute must be an array signal");if(!Array.isArray(r.value))throw new Error("the 'array' attribute must be an array signal");if(1!==t.length)throw new Error("the 'Each' compononent takes only one child, which should be a function");if("function"!=typeof t[0])throw new Error("the 'Each' compononent takes only one child, which should be a function");if("string"!=typeof o&&"function"!=typeof o&&("object"!=typeof o||!("jquery"in o)))throw new Error("the 'wrapper' attribute must be a component, string, or jquery object");const a=document.createDocumentFragment();let c;return a.append(...r.value.map(((e,n,r)=>i(l,null,t[0](e,n,r))[0]))),"object"==typeof o?(c=o,o.append(a)):c=i(o,null,e(a)),r.effect((function(){a.replaceChildren(...r.value.map(((e,n,r)=>i(l,null,t[0](e,n,r))[0]))),c[0].replaceChildren(a)})),c}function u({children:t,fallback:n=null}){const r=a(n||e(document.createTextNode("")));return Promise.all(t).then((e=>{r.content=i(l,null,...e)})),r.content}export{s as Case,f as Each,u as Patience,n as Signal,o as Slot,i as c,l as f,r as signal,a as slot};
